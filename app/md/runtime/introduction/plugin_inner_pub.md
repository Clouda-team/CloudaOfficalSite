# 插件发布

插件发布的流程见下图：

![](/md/images/pub_plugin_inner.png)

其中开发者只需完成“提交”即可，百度平台会完成后续的步骤。

## 插件提交

当您完成插件开发后，需要在平台上提交您的插件以及相应的材料并在插件包的manifest中声明插件相关内容。

（1）需要提交的材料如下

* 插件

	plg格式的插件包

* 插件图标

	用于插件展示的图标，**像素为54*54，大小一般小于10K**

* 接口说明文档

	开放的js接口列表以及参数说明

（2）在插件包的manifest中声明插件相关内容如下
<table style="border-style: solid; border-width: 0pt;" border="1" cellspacing="0" cellpadding="5px">
    <tbody>
        <tr>
            <th>字段名</th>
            <th>字段值</th>
        </tr>
        <tr>
			<td>name</td>
			<td>如:plugin1</td>
        </tr>
        <tr>
			<td>displayName</td>
			<td>如:测试插件</td>
        </tr>
        <tr>
			<td>version</td>
			<td>如:1.0.0.0</td>
        </tr>
        <tr>
			<td>description</td>
			<td>如:用于测试</td>
        </tr>      
   </tbody>
</table>

另外，插件匹配的Runtime版本号需要Runtime辅助产品线来确定。原则是：

*	插件开发者期望在哪些宿主(Runtime)上线插件
*	插件功能兼容的Runtime版本。这一项需要QA和产品线一起来测试确定。详细Runtime和宿主应用对照表见《附录1》。

如果插件中包含so文件，插件开发者需要确定能兼容的CPU类型。具体类型请见《附录2》。

（3）开发者提交插件时，可选新建插件和更新插件

* 提交新建插件时，manifest中声明的插件名必须是插件库不存在的，否则新建插件将被退回
* 更新插件时，manifest中声明的插件名必须是插件库中存在的(且插件属于当前开发者)，否则更新插件将被退回

## 审核

PM审核插件提交者资质：

* 是否具有正式上线的意义
* 定义插件所属等级

审核不通过则退回开发者。
## 测试

QA验证插件功能：

* 通过自动工具检测新建插件和更新插件，根据规则通过或退回插件(规则详见插件提交步骤)
* Review插件源代码，检查是否有恶意或者明显缺陷代码
* 查看接口与文档是否一致
* 验证接口基本功能
* 对照开发者提交的材料，验证插件和Runtime的兼容性
* 对照开发者提交的材料，验证插件兼容的CPU类型

功能验证不通过则退回开发者。

## 上线

RD/OP根据开发者提交材料操作插件上线。

上线规则：

* 上线前必须通知到PM,RD和QA负责人
* 一般为**理攀**上线，**李露**为上线人员备份
* 上线时间必须在10:00-18:00，方便QA做回归
* 必须RD和QA一起上线。如不能满足，则推迟上线

## 回归

RD上线完成后，QA立即进行线上回归。

回归规则：
* 回归时，需要回归插件兼容的所有Runtime(宿主)
* 需要保证插件兼容的CPU功能(不兼容的CPU类型不能下载插件，兼容的CPU类型可以下载插件)
* 如果出现插件上线问题(如安装失败，功能不正常，不兼容等情况)，半个小时之内必须下线插件。如果超过半小时，则有惩罚措施。详见《附录3》。

## 下线

当线上插件发现以下情况之一时可以采取下线处理。

* 具有重大Bug，造成轻应用/Runtime功能障碍
* 严重影响宿主/Runtime运行性能
* 恶意窃取用户信息

由QA发起下线插件流程，PM核准，RD/OP进行下线操作，QA确认插件下线，并确认使用该插件的轻应用也进行下线(调整功能)操作。
